clc
close all
clear all

f=[5
10
20
50
100
200
500
1000
2000
5000
10000
20000
50000
100000
200000];

A1 = [19.88
19.76
19.88
19.88
19.82
20.06
19.94
19.94
19.94
19.94
19.94
19.94
19.94
19.94
19.94];

% A1= [19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8
% 19.8];

A2 = [19.86
19.82
19.64
18.35
15.45
10.93
5.280
2.79
1.44
0.592
0.303
0.164
0.063
0.032
0.018];

% A2=[19.8
% 19.8
% 19.4
% 17.84
% 15
% 10.66
% 5.24
% 2.79
% 1.43
% 0.6
% 0.3
% 0.153
% 0.062
% 0.032
% 0.017];

Tx1=[1.50
1.45
1.250
1.200
1.060
0.780
0.410
0.230
0.1170
0.0480
0.0240
0.0124
0.005
0.0024
0.0013];

% Tx1=[5.8
% 5.8
% 5.5
% 4.97
% 3.9
% 2.37
% 0.7
% 0.3
% 0.14
% 0.05
% 0.025
% 0.012
% 0.005
% 0.0026
% 0.0011];


Tx2=[1.48
1.40
1.210
1.18
01.04
0.75
0.4
0.23
0.116
0.047
0.024
0.012
0.005
0.0024
0.0012];

% Tx2=[5.80
% 5.80
% 5.50
% 4.94
% 3.90
% 2.340
% 0.690
% 0.30
% 0.140
% 0.0052
% 0.025
% 0.012
% 0.005
% 0.0024
% 0.0012];


omega = 2*pi*f;

k = A2./A1;
Lm = 20*log10(k);
subplot(2,1,1)
semilogx(omega, Lm);
xlim([omega(1) omega(end)])
grid on
delta_t = Tx2-Tx1;
phi = (360 * omega .* (delta_t/1000))/(2*pi);
subplot(2,1,2)
semilogx(omega, phi)
grid on
ylim([-100 100])
xlim([omega(1) omega(end)])


x = k .* cosd(phi);
y = k .* sind(phi);
phi2=atan2(y,x);
figure()
plot(x,y)